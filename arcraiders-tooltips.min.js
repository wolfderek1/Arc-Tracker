"use strict";(function(){let m=0,H=null,p=new Map;const E=5*60*1e3;function v(){const e=Date.now();for(const[o,n]of p.entries())n.timestamp&&e-n.timestamp>=E&&p.delete(o)}setInterval(v,60*1e3);function C(e,o){return function(...u){const l=()=>{clearTimeout(H),e(...u)};clearTimeout(H),H=setTimeout(l,o)}}document.readyState!=="loading"?T():document.addEventListener("DOMContentLoaded",function(){T()});function T(){const e=document.body,o=document.createElement("div");o.className="loading-indicator",o.style.position="fixed",o.style.top="50%",o.style.left="50%",o.style.transform="translate(-50%, -50%)";const n=document.createElement("div");n.className="loading-spinner",n.style.border="2px solid #ccc",n.style.borderTop="2px solid #666",n.style.borderRadius="50%",n.style.width="24px",n.style.height="24px",n.style.animation="spin 1s linear infinite",n.style.pointerEvents="none",o.appendChild(n),o.style.position="absolute",o.style.left="-9999px",o.style.zIndex="9999999",e.appendChild(o);const u=new CSSStyleSheet;u.insertRule(`
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  `),document.adoptedStyleSheets=[u],e.addEventListener("mousemove",function(i){var s,d,c,a,f;let t=i.target;if(!(t&&((s=t.dataset)!=null&&s.tooltipHref)&&w((d=t.dataset)==null?void 0:d.tooltipHref)))for(;t&&t.tagName!=="A";)t=t.parentNode;t&&(t.tagName==="A"&&(t.href||(c=t.dataset)!=null&&c.tooltipHref)||(a=t.dataset)!=null&&a.tooltipHref)&&w(t.href||((f=t.dataset)==null?void 0:f.tooltipHref))?(o.style.left=i.pageX+32+"px",o.style.top=i.pageY+32+"px",document.getElementById("arcraiders-tooltip")||l(i,t)):(o.style.left="-9999px",b())});const l=C(function(i,t){L(i,t)},50);e.addEventListener("mouseout",function(i){var t;(i.target.tagName==="A"||(t=i.target.dataset)!=null&&t.tooltipHref)&&b()}),e.addEventListener("click",function(i){var t;(i.target.tagName==="A"||(t=i.target.dataset)!=null&&t.tooltipHref)&&b()}),window.addEventListener("message",i=>{if(!i.data)return;const t=document.getElementById("arcraiders-tooltip"),s=document.querySelector(".loading-indicator");i.data.hasOwnProperty("FrameHeight")&&w(i.data.href||i.data.dataset.tooltipHref)&&(m=i.data.FrameHeight,t&&(s&&(s.style.left="-9999px"),t.style.height=`${m}px`,t.style.opacity="1")),P(i,t,s)})}function w(e){return e?!e.includes("?widget=true")&&(e.includes("metaforge.app/arc-raiders/database/item/")||e.includes("localhost:5173/arc-raiders/database/item/")||e.includes("metaforge.app/arc-raiders/database/quest/")||e.includes("localhost:5173/arc-raiders/database/quest/")||e.includes("metaforge.app/arc-raiders/database/arc/")||e.includes("localhost:5173/arc-raiders/database/arc/")):!1}function b(){const e=document.querySelector(".loading-indicator");e&&(e.style.left="-9999px"),Array.from(document.getElementsByClassName("arcraiders-tooltip")).forEach(o=>o.remove())}const L=(e,o)=>{var x;let t=document.getElementById("arcraiders-tooltip");if(t)return;const s=((x=o.dataset)==null?void 0:x.tooltipHref)||o.href;if(!s||!w(s))return;const d=new URL(s);d.searchParams.set("embed","true");const c=d.toString();if(p.has(c)){const r=p.get(c),g=Date.now();if(r.timestamp&&g-r.timestamp<E){const h=document.querySelector(".loading-indicator");h&&(h.style.left="-9999px"),S(e,r,350,0,.8,15);return}else p.delete(c)}t=document.createElement("div"),t.id="arcraiders-tooltip";var a=document.createElement("iframe");a.style.width="350px",a.style.height="100%",a.style.padding="0",a.style.margin="0",a.style.display="block",a.style.border="none",a.style.overflow="hidden",a.id="arcraiders-tooltip-frame",a.src=c,a.addEventListener("load",function(){try{const r=a.contentDocument||a.contentWindow.document;if(r&&r.body){const g=r.body.innerHTML,h=r.body.scrollHeight;if(p.set(c,{content:g,height:h,timestamp:Date.now()}),p.size>50){const I=p.keys().next().value;p.delete(I)}}}catch(r){p.set(c,{content:null,height:0,timestamp:Date.now(),loaded:!0})}}),t.appendChild(a),t.style.width="350px",t.style.height="0px",t.style.color="#fff",t.style.borderRadius="8px",t.style.padding="0",t.style.position="fixed",t.style.boxShadow="0px 0px 0px 1px rgba(0,0,0,1)",t.style.zIndex="2147483647",t.style.opacity="0",t.style.transform=`scale(${.8})`,t.style["transform-origin"]="0 0",t.scrolling="no",t.sandbox="allow-scripts allow-popups allow-same-origin",t.classList="arcraiders-tooltip";function f(r){const g=Math.min(r.clientX+15,window.innerWidth-280-15);let h=r.clientY+15;return h+m*.8+15>window.innerHeight&&(h=window.innerHeight-m*.8-15),{left:g,top:h}}const y=f(e);t.style.left=y.left+"px",t.style.top=y.top+"px",document.body.appendChild(t),o.addEventListener&&o.addEventListener("mousemove",r=>{const g=f(r);requestAnimationFrame(()=>{t.style.left=g.left+"px",t.style.top=g.top+"px"})})},S=(e,o,n,u,l,i)=>{let t=document.createElement("div");t.id="arcraiders-tooltip",o.content?(t.innerHTML=o.content,m=o.height||200):(t.innerHTML='<div style="padding: 20px; text-align: center;">Loading...</div>',m=100),t.style.width=`${n}px`,t.style.height=`${m}px`,t.style.color="#fff",t.style.textAlign="center",t.style.borderRadius="8px",t.style.padding="0",t.style.position="fixed",t.style.boxShadow="0px 0px 0px 1px rgba(0,0,0,1)",t.style.zIndex="2147483647",t.style.opacity="1",t.style.transform=`scale(${l})`,t.style["transform-origin"]="0 0",t.style.overflow="hidden",t.classList="arcraiders-tooltip";function s(f){const y=Math.min(f.clientX+i,window.innerWidth-n*l-i);let x=f.clientY+i;return x+m*l+i>window.innerHeight&&(x=window.innerHeight-m*l-i),{left:y,top:x}}const d=s(e);t.style.left=d.left+"px",t.style.top=d.top+"px",document.body.appendChild(t);const c=function(f){const y=s(f);requestAnimationFrame(()=>{t.style.left=y.left+"px",t.style.top=y.top+"px"})};document.addEventListener("mousemove",c);const a=t.remove;t.remove=function(){document.removeEventListener("mousemove",c),a.call(this)}};function P(e,o,n){var t,s;const u=[...document.querySelectorAll("iframe")].find(d=>d.contentWindow===e.source);if(!u)return;const l=u.getBoundingClientRect(),i={pageX:l.x+e.data.x,pageY:l.y+e.data.y,clientX:l.x+e.data.x,clientY:l.y+e.data.y};if(n&&(n.style.left=i.pageX+32+"px",n.style.top=i.pageY+32+"px"),o)e.data.type==="mousemove"&&requestAnimationFrame(()=>{o.style.left=`${i.pageX}px`,o.style.top=`${i.pageY}px`}),e.data.type==="mouseleave"&&b();else{const d=((s=(t=e.data)==null?void 0:t.dataset)==null?void 0:s.tooltipHref)||e.data.href;L(i,{href:d})}}})();
